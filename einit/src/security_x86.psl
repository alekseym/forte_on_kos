use security._
use external._

use EDL kl.drivers.ATA
use EDL kl.drivers.PCIE

/**
 * This instruction enables to start up and initialize non-platform kl.drivers.PCIE entity.
 */
execute src=Einit, dst=kl.drivers.PCIE
{
    grant()
}

request src=kl.drivers.PCIE, dst=kl.core.Core
{
    grant()
}

response src=kl.core.Core, dst=kl.drivers.PCIE
{
    grant()
}

request src=kl.drivers.ATA, dst=kl.drivers.PCIE
{
    grant()
}

response src=kl.drivers.PCIE, dst=kl.drivers.ATA
{
    grant()
}

request src=kl.drivers.ATA, dst=kl.core.Core
{
    grant()
}

response src=kl.core.Core, dst=kl.drivers.ATA
{
    grant()
}

request src=vfs_user.VfsUser, dst=kl.drivers.ATA
{
    grant()
}

response src=kl.drivers.ATA, dst=vfs_user.VfsUser
{
    grant()
}

/**
 * Next policy enables ATA driver to interact with security monitor.
 * It enables to register new port.
 */
security src=kl.drivers.ATA
{
    grant ()
}
